<style>
	h4,h5,p{
		font-family: '微软雅黑';
	}
	h5,p{
		font-size: 15px;
		line-height: 20px;
		margin-bottom: 4px;
	}
	code{
		background-color: #f1f1f1;
		padding: 0 4px;
		font-size: inherit;
	}
	a{
		color: blue;
		font-size: inherit;
	}
</style>
<h4>应用百度地图Web API开发小应用</h4>
<p>百度地图Web服务API为开发者提供http接口，即开发者通过http形式发起检索请求，获取返回json或xml格式的检索数据。</p>
<p>进入官网http://lbsyun.baidu.com/index.php，注册并登录，然后申请秘钥。</p>
<p>接下来带领大家熟悉百度地图web API，并应用API开发一个小应用</p>
<h4>API简介</h4>
<h5>1.Place API</h5>
<p>支持城市、矩形及圆形区域关键字检索POI，返回json/xml格式的POI数据。</p>
<pre>var ak = 'hNwsSIXFOPTIQQuze00VDuYydoIXgAFF';
var url = 'http://api.map.baidu.com/place/v2/search?q=饭店&region=北京&output=json&ak='+ak;
$.getJSON(url + '&callback=?',function (res) {
    if (res.status === 0) {
        console.log(res)
    }else{
        alert('没有找到该地址信息')
    }
})</pre>
<p>参数含义</p>
<p>q：检索关键字</p>
<p>region：检索区域（在城市检索有效）</p>
<p>output：输出格式</p>
<p>ak：秘钥</p>
<img src="1.png" alt="">
<h5>2.Place suggestion API</h5>
<p>提供匹配用户输入关键字的辅助信息、提示接口、返回json/xml格式的建议词条数据。</p>
<pre>var ak = 'hNwsSIXFOPTIQQuze00VDuYydoIXgAFF';
var url = 'http://api.map.baidu.com/place/v2/suggestion?q=天安门&region=北京市&city_limit=true&output=json&ak='+ak;
$.getJSON(url + '&callback=?',function (res) {
    if (res.status === 0) {
        console.log(res)
    }else{
        alert('没有找到该地址信息')
    }
})</pre>
<p>参数含义</p>
<p>q：检索关键字</p>
<p>region：指定区域，可能返回其他区域结果，禁止返回其他区域结果需要配合city_limit</p>
<p>city_limit：当为true时，只返回指定区域的结果</p>
<p>output：输出格式</p>
<p>ak：秘钥</p>
<img src="2.png" alt="">
<h5>3.Geocoding API</h5>
<p>通过地址获取坐标值或通过坐标点获取详细地址信息描述服务。</p>
<pre>var ak = 'hNwsSIXFOPTIQQuze00VDuYydoIXgAFF';
var url = 'http://api.map.baidu.com/geocoder/v2/?output=json&ak='+ak+'&address=北京市'     
$.getJSON(url + '&callback=?',function (res) {
    if (res.status === 0) {
        console.log(res)
    }else{
        alert('没有找到该地址信息')
    }
})</pre>
<p>参数含义</p>
<p>address：地址</p>
<p>output：输出格式</p>
<p>ak：秘钥</p>
<img src="3.png" alt="">
<h5>4.Direction API</h5>
支持公交、驾车、步行查询检索服务，返回json/xml格式的线路数据。
<pre>var ak = 'hNwsSIXFOPTIQQuze00VDuYydoIXgAFF';
var url = 'http://api.map.baidu.com/direction/v1?mode=driving&origin=清华大学&destination=北京大学&origin_region=北京&destination_region=北京&output=json&ak='+ak;    
$.getJSON(url + '&callback=?',function (res) {
    if (res.status === 0) {
        console.log(res)
    }else{
        alert('没有找到该地址信息')
    }
})</pre>
<p>参数含义</p>
<p>mode：导航模式包括：driving（驾车）、walking（步行）、transit（公交）、riding（骑行）</p>
<p>origin：起点名称或经纬度</p>
<p>destination：终点名称或经纬度</p>
<p>origin_region：起点所在城市</p>
<p>destination_region：终点所在城市</p>
<p>output：输出类型</p>
<p>ak：秘钥</p>
<img src="4.png" alt="">
<h5>5.IP定位API</h5>
<p>根据IP获取用户的位置信息。</p>
<pre>var ak = 'hNwsSIXFOPTIQQuze00VDuYydoIXgAFF';
var url = 'http://api.map.baidu.com/location/ip?ip=123.114.62.230&coor=bd09ll&ak='+ak;    
$.getJSON(url + '&callback=?',function (res) {
    if (res.status === 0) {
        console.log(res)
    }else{
        alert('没有找到该地址信息')
    }
})</pre>
<p>参数含义</p>
<p>ip：检索的ip地址</p>
<p>coor：输出的坐标格式，coor=bd09ll时，返回为百度经纬度坐标。</p>
<p>ak：秘钥</p>
<img src="5.png" alt="">
<h5>6.Route Matrix API</h5>
<p>提供同时查询多个起终点线路信息的数据接口。</p>
<pre>var ak = 'hNwsSIXFOPTIQQuze00VDuYydoIXgAFF';
var url = 'http://api.map.baidu.com/routematrix/v2/driving?output=json&origins=40.45,116.34|40.54,116.35&destinations=40.34,116.45|40.35,116.46&ak='+ak;    
$.getJSON(url + '&callback=?',function (res) {
    if (res.status === 0) {
        console.log(res)
    }else{
        alert('没有找到该地址信息')
    }
})</pre>
<p>参数含义</p>
<p>origins：起点，用经纬度表示，多个经纬度用|分开</p>
<p>destinations：终点，用经纬度表示，多个经纬度用|分开</p>
<p>output：输出格式</p>
<p>ak：秘钥</p>
<img src="6.png" alt="">

<h4>应用API开发应用</h4>
<p>这个应用很简单，如下图所示。</p>
<p><img src="0.png" alt=""></p>
<p>思路很简单</p>
<p>1.获取当前城市根据，需要借助新浪api接口。当然也可以采用其他方法获取当前城市。</p>
<p>2.根据输入的起点和终点，获取路程信息。</p>
<textarea class="demo">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
	&lt;meta charset=&quot;UTF-8&quot;&gt;
	&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1, maximum-scale=1&quot;&gt;
	&lt;title&gt;小应用&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
	&lt;div id=&quot;container&quot;&gt;
		&lt;h3&gt;当前城市：&lt;span id=&quot;city&quot;&gt;&lt;/span&gt;&lt;/h3&gt;
		&lt;p&gt;
			起点：
			&lt;select id=&quot;srcCity&quot;&gt;
				&lt;option value=&quot;北京&quot; checked&gt;北京&lt;/option&gt;
				&lt;option value=&quot;廊坊&quot;&gt;廊坊&lt;/option&gt;
				&lt;option value=&quot;沧州&quot;&gt;沧州&lt;/option&gt;
				&lt;option value=&quot;天津&quot;&gt;天津&lt;/option&gt;
			&lt;/select&gt;
			&lt;input type=&quot;text&quot; id=&quot;src&quot; value=&quot;清华大学&quot;&gt;
		&lt;/p&gt;
		&lt;p&gt;
			终点：
			&lt;select id=&quot;desCity&quot;&gt;
				&lt;option value=&quot;北京&quot; checked&gt;北京&lt;/option&gt;
				&lt;option value=&quot;廊坊&quot;&gt;廊坊&lt;/option&gt;
				&lt;option value=&quot;沧州&quot;&gt;沧州&lt;/option&gt;
				&lt;option value=&quot;天津&quot;&gt;天津&lt;/option&gt;
			&lt;/select&gt;
			&lt;input type=&quot;text&quot; id=&quot;des&quot; value=&quot;北京大学&quot;&gt;
		&lt;/p&gt;
		&lt;p&gt;&lt;button type=&quot;button&quot; id=&quot;search&quot;&gt;查询&lt;/button&gt;&lt;/p&gt;
	&lt;/div&gt;
	
	&lt;div id=&quot;result&quot;&gt;&lt;/div&gt;
	&lt;script src=&quot;http://int.dpool.sina.com.cn/iplookup/iplookup.php?format=js&quot;&gt;&lt;/script&gt;
	&lt;script src=&quot;http://cdn.staticfile.org/jquery/1.11.2/jquery.min.js&quot;&gt;&lt;/script&gt;
	&lt;script&gt;
		var $search = $(&quot;#search&quot;);
		var $src = $(&quot;#src&quot;);
		var $des = $(&quot;#des&quot;);
		var $srcCity = $(&quot;#srcCity&quot;);
		var $desCity = $(&quot;#desCity&quot;);
		var $result = $(&quot;#result&quot;)
		var ak = &#x27;hNwsSIXFOPTIQQuze00VDuYydoIXgAFF&#x27;;
		var city = remote_ip_info[&#x27;city&#x27;];
		$(&#x27;#city&#x27;).html(city);

		$search.on(&#x27;click&#x27;,function(){
			var srcVal = $src.val();
			var desVal = $des.val();
			var srcCityVal = $srcCity.val();
			var desCityVal = $desCity.val();
			if (!srcVal || !desVal || !srcCityVal || !desCityVal) {
				return false
			}
			getRoute(srcVal,desVal,srcCityVal,desCityVal,function () {
				$result.empty()
			})
		})
		// 获取路程信息
		function getRoute(begin,end,beginCity,endCity,cb) {
			var url = &#x27;http://api.map.baidu.com/direction/v1?mode=driving&amp;origin=&#x27;+begin+&#x27;&amp;destination=&#x27;+end+&#x27;&amp;origin_region=&#x27;+beginCity+&#x27;&amp;destination_region=&#x27;+endCity+&#x27;&amp;output=json&amp;ak=&#x27;+ak;    
	        $.getJSON(url + &#x27;&amp;callback=?&#x27;)
	        .done(function (res) {
	            if (res.status === 0) {
	            	cb &amp;&amp; cb()
	                // console.log(res)
	                var html = &#x27;&lt;p id=&quot;search&quot;&gt;从&lt;b&gt;&#x27;+res.result.origin.cname+&#x27; &#x27; +res.result.origin.wd+&#x27;&lt;/b&gt;&#x27;;
	                html += &#x27;到&#x27;+res.result.destination.cname+&#x27; &#x27; +res.result.destination.wd+&#x27;&lt;/b&gt;&lt;/p&gt;&#x27;;

	                html += &#x27;&lt;p id=&quot;distance&quot;&gt;距离：&#x27;+getKM(res.result.routes[0].distance)+&#x27;&lt;/p&gt;&#x27;
	                html += &#x27;&lt;p id=&quot;duration&quot;&gt;耗时：&#x27;+formatSeconds(res.result.routes[0].duration)+&#x27;&lt;/p&gt;&#x27;
	                html += &#x27;&lt;ul id=&quot;steps&quot;&gt;&#x27;
	                $.each(res.result.routes[0].steps,function (index,value) {
	                	html += &#x27;&lt;li id=&quot;step&#x27;+index+&#x27;&quot;&gt;&lt;p&gt;&#x27;+(index+1)+&#x27;:&#x27;+value.instructions+&#x27;。&lt;/p&gt;&lt;p&gt;路段长度：&#x27;+getKM(value.distance)+&#x27;。耗时:&#x27;+formatSeconds(value.duration)+&#x27;&lt;/p&gt;&lt;/li&gt;&#x27;
	                })
	                html += &#x27;&lt;/ul&gt;&#x27;
	                $result.append(html)

	            }else{
	                alert(&#x27;没有找到该地址信息&#x27;)
	            }
	        })
		}
		// 米转千米
		function getKM(m) {
			return m/1000 + &#x27;千米&#x27;
		}
		// 秒转时分秒
		function formatSeconds(value) { 
			var theTime = parseInt(value);// 秒 
			var theTime1 = 0;// 分 
			var theTime2 = 0;// 小时 
			// alert(theTime); 
			if(theTime &gt; 60) { 
				theTime1 = parseInt(theTime/60); 
				theTime = parseInt(theTime%60); 
				// alert(theTime1+&quot;-&quot;+theTime); 
				if(theTime1 &gt; 60) { 
					theTime2 = parseInt(theTime1/60); 
					theTime1 = parseInt(theTime1%60); 
				} 
			} 
			var result = &quot;&quot;+parseInt(theTime)+&quot;秒&quot;; 
			if(theTime1 &gt; 0) { 
				result = &quot;&quot;+parseInt(theTime1)+&quot;分&quot;+result; 
			} 
			if(theTime2 &gt; 0) { 
				result = &quot;&quot;+parseInt(theTime2)+&quot;小时&quot;+result; 
			} 
			return result; 
		} 
	&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</textarea>
<h4>总结</h4>
<p>上面的例子很精简，很多地方需要优化。比如：</p>
<p>我们获取到的检索信息都包含了的经纬度信息，我们可以根据经纬度把地点绘制在地图上（如echarts组件知道经纬度就能在地图中绘制出地点），在加上交互效果，就能开发出丰富多彩的地图服务应用。</p>

